/**
 * Serenity UI v2017.1.170720 (https://www.serenityui.com)
 */
!function(t,e){e.Model=e.Observable.extend({_pristine:null,dirty:null,UUID:null,events:["change"],options:{id:null},constructor:function(t,i){e.Observable.call(this,i),this.dirty=!1,this.UUID=e.guid(),arguments.length>0&&(this._pristine=t,this._initProperties(t))},set:function(t,e){var i=this[t]!=e;if(i){var s=void 0!==this[t]?this._cloneProperty(t):void 0;this._setProperty(t,e),this.dirty=!0,this.trigger("change",{model:this,property:t,value:this[t],before:s})}return i},toJSON:function(){var t={},i=",";for(var s in e.Model.prototype)i+=s+",";for(var s in this)-1===i.indexOf(","+s+",")&&(t[s]=this[s]);return t},rollback:function(){try{if("object"==typeof this._pristine){for(var t in this._pristine)this[t]=this._pristine[t];this.dirty=!1}}catch(t){}return this},commit:function(){try{if("object"==typeof this._pristine){for(var t in this._pristine)this._pristine[t]=this[t];this.dirty=!1}}catch(t){}return this}})}(window.jQuery,window.serenity),function(t,e){e.overlay={show:function(i){var i=t.extend({element:t("body"),text:"",cssClass:""},i);return t.Deferred(function(s){var n=i.element.find(".jx-overlay");0===n.length?(n=t(e.format("<div class='jx-overlay'><div class='ui-widget-overlay ui-front'></div><div class='jx-overlay-text'>{0}</div></div>",i.text)),i.element.append(n)):(n.find(".jx-overlay-text").attr("class","jx-overlay-text"),n.find(".jx-overlay-text").text(i.text)),i.cssClass.length>0&&n.find(".jx-overlay-text").addClass(i.cssClass),n.show(),setTimeout(function(){s.resolve()},10)}).promise()},hide:function(e){var e=t.extend({element:t("body")},e),i=e.element.find(".jx-overlay");i.length>0&&i.remove()}}}(window.jQuery,window.serenity),function(t){t.widget("serenity.filtermenu",t.serenity.datawidget,{options:{dataSource:[],field:null},events:["clear","filter"],html:{content:"<div class='ui-widget-content sr-filter-input' style='width:200px;height:200px;'><span style='display: block; margin-bottom: 1em;'>Show items where:</span><select class='sr-filter-operator' style='width:175px;'><option value='eq'>equals</option><option value='neq'>not equals</option><option value='contains'>contains</option><option value='doesnotcontain'>does not contain</option><option value='startswith'>starts with</option><option value='endswith'>ends with</option><option value='empty' data-value='false'>empty</option><option value='notempty' data-value='false'>not empty</option><option value='gt'>greater than</option><option value='lt'>less than</option></select><input class='sr-input sr-filter-value' style='width:165px;margin-top:1.1em;'/><button class='sr-clear-button' style='position:absolute;bottom:10px;left:10px;'>Clear</button><button class='sr-filter-button' style='position:absolute;bottom:10px;right:10px;'>Filter</button></div>"},_create:function(){this._super(),this.setDataSource(this.options.dataSource),this._render()},_createWidgets:function(){this.element.find("button.sr-clear-button").button().data("uiButton").element.on("click",t.proxy(this._onClear,this)),this.element.find("button.sr-filter-button").button().data("uiButton").element.on("click",t.proxy(this._onFilter,this)),this.widgets.value=this.element.find("input.sr-filter-value"),this.widgets.operator=this.element.find("select.sr-filter-operator").selectmenu({width:175}).data("uiSelectmenu")},_onClear:function(t){t.stopPropagation(),this._dataSource.filter([]),this._trigger("clear")},_onFilter:function(t){t.stopPropagation();var e=this.options.field,i=this.widgets.operator.element.select().find("option:selected"),s=i.val(),n="false"!==i.attr("data-value"),o=this.widgets.value.val();e.length>0&&s.length>0&&(o.length>0||!1===n)&&(this._dataSource.filter({field:e,operator:s,value:o}),this._trigger("filter"))},_render:function(){this.element.append(this.html.content),this._createWidgets()},load:function(t){this.options.field=t;var e=Enumerable.From(this._dataSource.options.filter).Where(function(e){return e.field===t}).FirstOrDefault();void 0!==e&&(this.widgets.operator.element.val(e.operator),this.widgets.operator.refresh(),this.widgets.value.val(e.value))}})}(window.jQuery),function(t){t.widget("serenity.pagerpanel",t.serenity.datawidget,{options:{dataSource:[],messages:{goto:"Go to page:",pagesize:"Show rows",items:Handlebars.compile("{{start}}-{{end}} of {{size}}")},pagesizes:[10,25,50,100]},html:{content:"<div class='ui-widget-content'><div class='sr-pagerpanel-input'><div class='sr-pagerpanel-gotopage'><span class='sr-pagerpanel-pagemessage'>Go to page:</span><input class='ui-widget-input sr-pagerpanel-pagenum' /></div><div class='sr-pagerpanel-pagesize'><span class='sr-pagerpanel-sizemessage'>Show rows:</span><select class='sr-pagerpanel-sizeselect'></select></div><div class='sr-pagerpanel-navigate'><span class='sr-pagerpanel-items'></span><button class='sr-pagerpanel-prev'></button><button class='sr-pagerpanel-next'></button></div></div></div>"},_create:function(){this._super(),this.element.append(this.html.content),this.widgets.pageNumber=this.element.find(".sr-pagerpanel-pagenum"),this.widgets.pageNumber.on("blur",t.proxy(this._onPageNumberChange,this)),this.widgets.pageSize=this.element.find(".sr-pagerpanel-sizeselect").serenityDropdownlist({dataSource:new serenity.DataSource,textField:"size",valueField:"size",width:70,change:t.proxy(this._onPageSizeChange,this)}).data("serenityDropdownlist"),this.element.find("button.sr-pagerpanel-prev").button({icons:{primary:"fa fa-caret-left"}}).click(t.proxy(this._onPrev,this)).find(".ui-button-icon").removeClass("ui-button-icon").removeClass("ui-icon"),this.element.find("button.sr-pagerpanel-next").button({icons:{primary:"fa fa-caret-right"}}).click(t.proxy(this._onNext,this)).find(".ui-button-icon").removeClass("ui-button-icon").removeClass("ui-icon"),this.setDataSource(this.options.dataSource)},_onDataSourceChange:function(){this.load()},_onPageNumberChange:function(){var t=this.options.dataSource.options.page,e=parseInt(this.widgets.pageNumber.val());e>0&&e<=t.count?this.options.dataSource.changePage(e):this.widgets.pageNumber.val(t.current)},_onPageSizeChange:function(t,e){this._dataSource.changePage(1,this.widgets.pageSize.dataItem().size)},_onPrev:function(){var t=this.options.dataSource.options.page;t.current>1&&(this.options.dataSource.changePage(t.current-1),this.load())},_onNext:function(){var t=this.options.dataSource.options.page;t.current<t.count&&(this.options.dataSource.changePage(t.current+1),this.load())},load:function(){if(this._dataSourceValid){var e=this._dataSource.options.page;this.widgets.pageNumber.val(e.current);var i=t.merge([],this.options.pagesizes);null!==e.size&&-1===i.indexOf(e.size)&&i.push(e.size);var s=Enumerable.From(i).Select(function(t){return{size:t}}).OrderBy("$.size").ToArray();this.widgets.pageSize._dataSource.data(s),this.widgets.pageSize.value(e.size);var n=this._dataSource.view().Count(),o=(e.current-1)*e.size,a=o+this._dataSource._current.page.Count();this.element.find(".sr-pagerpanel-items").text(this.options.messages.items({start:o+1,end:a,size:n}))}},setDataSource:function(t){this._super(t),this.load()}})}(window.jQuery),function(t){"use strict";t.widget("serenity.notificationpanel",t.serenity.widget,{_timeout:null,_notification:null,_direction:null,show:function(t){var e=this;this._notification=t;var i="bottom"===t.options.animation.show?"down":"top"===t.options.animation.show?"up":t.options.animation.show;e.element.show("slide",{direction:i},function(){e._trigger.call(e,"show"),t.options.hideOnClick&&(e.element.addClass("sr-hide-on-click"),e.element.on("click.notificationpanel",function(t){e._trigger.call(e,"click",t),clearTimeout(e._timeout),e.hide.call(e)}))}),t.options.duration>0&&(this._timeout=setTimeout(function(){e.hide.call(e)},t.options.duration))},hide:function(){var t=this;if(t.element.off("click.notificationpanel"),this.element.is(":visible")){var e="bottom"===this._notification.options.animation.hide?"down":"top"===this._notification.options.animation.hide?"up":this._notification.options.animation.hide;this.element.hide("slide",{direction:e},function(){t._trigger.call(t,"hide"),t.destroy()})}}})}(window.jQuery),function(t,e){"use strict";t.widget("serenity.rating",t.serenity.widget,{_pause:null,_pixels:null,_intermediate:null,_width:null,_interval:null,_steps:null,html:{wrapper:"<div class='sr-rating-wrapper' style='display:inline-block;'><div class='sr-rating-container' style='position:relative;display:inline-block;'></div></div>",font:{available:Handlebars.compile("<div class='sr-rating-available' style='font-size:{{fontSize}};color:{{color}};display:inline-block;'>{{content}}</div>",{noEscape:!0}),selected:Handlebars.compile("<div class='sr-rating-selected' style='font-size:{{fontSize}};color:{{color}};position:absolute;top:0px;left:0px;overflow:hidden;width:0px;'>{{content}}</div>",{noEscape:!0}),highlight:Handlebars.compile("<div class='sr-rating-highlight' style='font-size:{{fontSize}};color:{{color}};position:absolute;top:0px;left:0px;width:0px;overflow:hidden;'>{{content}}</div>",{noEscape:!0})},icon:{available:Handlebars.compile("<div class='sr-rating-available {{cssClass}}' style='height:{{height}}px;display:inline-block;width:{{width}}px;'></div>",{noEscape:!0}),selected:Handlebars.compile("<div class='sr-rating-selected {{cssClass}}' style='height:{{height}}px;position:absolute;top:0px;left:0px;overflow:hidden;width:0px;'></div>",{noEscape:!0}),highlight:Handlebars.compile("<div class='sr-rating-highlight {{cssClass}}' style='height:{{height}}px;position:absolute;top:0px;left:0px;width:0px;overflow:hidden;'></div>",{noEscape:!0})},clear:Handlebars.compile("<i class='sr-rating-clear {{cssClass}}' data-color='{{color}}' data-highlight-color='{{highlightColor}}' style='color:{{color}};float:left;'></i>",{noEscape:!0})},options:{count:5,step:.5,value:null,readonly:!1,mode:"font",font:{code:null,char:null,size:"1em",availableColor:"gray",highlightColor:"goldenrod",selectedColor:"red"},icon:{width:null,height:null,availableClass:null,highlightClass:null,selectedClass:null},clear:{visible:!0,cssClass:"fa fa-minus-circle",color:null,highlightColor:null}},_create:function(){this._super(),this.element.after(this.html.wrapper),this.widgets.wrapper=this.element.next("div.sr-rating-wrapper"),this.widgets.container=this.widgets.wrapper.find(".sr-rating-container"),this.widgets.wrapper.append(this.element),this.element.hide(),"font"===this.options.mode?this._renderFont():this._renderIcon(),this._renderClear(),this._initEvents(),this._intermediate={pixels:0,steps:0},this.load()},_renderFont:function(){for(var t="",e=null!==this.options.font.code?String.fromCharCode(this.options.font.code):null!==this.options.font.char?this.options.font.char:String.fromCharCode(9733),i=0;i<this.options.count;i++)t+=e;this.widgets.container.append(this.html.font.available({fontSize:this.options.font.size,color:this.options.font.availableColor,content:t})),this.widgets.available=this.widgets.container.find(".sr-rating-available"),this.widgets.container.append(this.html.font.selected({fontSize:this.options.font.size,color:this.options.font.selectedColor,content:t})),this.widgets.selected=this.widgets.container.find(".sr-rating-selected"),this.widgets.container.append(this.html.font.highlight({fontSize:this.options.font.size,color:this.options.font.highlightColor,content:t})),this.widgets.highlight=this.widgets.container.find(".sr-rating-highlight")},_renderIcon:function(){var t=this.options.count*this.options.icon.width,e=this.options.icon.height;this.widgets.container.append(this.html.icon.available({cssClass:this.options.icon.availableClass,height:e,width:t})),this.widgets.available=this.widgets.container.find(".sr-rating-available"),this.widgets.container.append(this.html.icon.selected({cssClass:this.options.icon.selectedClass,height:e})),this.widgets.selected=this.widgets.container.find(".sr-rating-selected"),this.widgets.container.append(this.html.icon.highlight({cssClass:this.options.icon.highlightClass,height:e})),this.widgets.highlight=this.widgets.container.find(".sr-rating-highlight")},_renderClear:function(){if(!0===this.options.clear.visible){var e=this.options.clear;null===e.color&&(e.color=this.options.font.availableColor),null===e.highlightColor&&(e.highlightColor=this.options.font.selectedColor),this.widgets.wrapper.prepend(this.html.clear(this.options.clear)),this.widgets.clear=this.widgets.wrapper.find(".sr-rating-clear"),this.widgets.clear.css("margin-top",(this.widgets.container.height()-this.widgets.clear.height())/2+"px"),this.widgets.clear.on("mouseenter",function(){var e=t(this);e.css("color",e.attr("data-highlight-color"))}),this.widgets.clear.on("mouseleave",function(){var e=t(this);e.css("color",e.attr("data-color"))});var i=this;this.widgets.clear.on("click",function(){i._intermediate={pixels:0,steps:0},i._setSelectedValue()})}},_initEvents:function(){!1===this.options.readonly&&(this.widgets.container.on("mousemove",t.proxy(this._onMouseMove,this)),this.widgets.container.on("mouseleave",t.proxy(this._onMouseLeave,this)),this.widgets.container.on("click",t.proxy(this._onClick,this)))},_initIntervalValues:function(){var t=this.widgets.available.width();this._width!==t&&(this._width=t,this._steps=this.options.count/this.options.step,this._interval=this._width/this._steps)},_calculateSelectedSteps:function(t){var e=!1,i=0;this._initIntervalValues();for(var s=1;s<=this._steps&&!1===e;s++)t<s*this._interval&&t>(s-1)*this._interval&&(i=s,e=!0);return!0===e?i:this._intermediate.steps},_calculateSelectedPixels:function(t){return this._initIntervalValues(),t*this._interval},_convertValueToSteps:function(t){return t/this.options.step},_convertStepsToValue:function(t){return t*this.options.step},_onMouseMove:function(t){!0!==this._pause&&(this.widgets.selected.width(0),this._intermediate.steps=this._calculateSelectedSteps(t.offsetX),this._intermediate.pixels=this._calculateSelectedPixels(this._intermediate.steps),this.widgets.highlight.css("width",this._intermediate.pixels+"px"))},_onMouseLeave:function(){this.widgets.highlight.width(0),this.widgets.selected.width(this._pixels)},_onClick:function(){this._setSelectedValue()},_setSelectedValue:function(){this._pause=!0,this.widgets.highlight.width(0),this.options.value=this._convertStepsToValue(this._intermediate.steps),this._pixels=this._intermediate.pixels,this.element.val(this.options.value),this.widgets.selected.css("width",this._pixels+"px"),this._trigger("change",null,{value:this.options.value});var t=this;setTimeout(function(){t._pause=!1},250)},load:function(){var e=0;if(t.isNumeric(this.options.value))e=this.options.value;else{var i=this.element.val();i.length>0&&(e=parseFloat(i))}this._pixels=this._calculateSelectedPixels(this._convertValueToSteps(e)),this.widgets.selected.css("width",this._pixels+"px")}})}(window.jQuery,window.serenity),function(t,e){t.widget("serenity.autocomplete",t.ui.autocomplete,e._dataWidgetDef),t.widget("serenity.autocomplete",t.serenity.autocomplete,{options:{dataSource:[],height:null,index:null,itemTemplate:null,text:null,textField:null,value:null,valueField:null,source:[]},_create:function(){this._super(),this.element.css("padding","5px"),this.setDataSource(this.options.dataSource)},_onDataSourceChange:function(){this.refresh()},_renderItem:function(t,e){var i=this,s=this._super(t,e);if(this._dataSourceValid()&&null!==this.options.itemTemplate){var n=s.text(),o=this._dataSource.view().Where(function(t){return t[i.options.textField]===n}).FirstOrDefault(),a=this.options.itemTemplate(o);s.html(a)}return s},dataItem:function(){var t=this,e=this.element.val();return this._dataSource.view().Where(function(i){return i[t.options.textField]==e}).FirstOrDefault()},setDataSource:function(t){this._super(t),this._dataSourceValid()&&(null!==this.options.index?this.index(this.options.index):null!==this.options.value?this.value(this.options.value):null!==this.options.text?this.text(this.options.text):this.refresh())},index:function(t){this.options.index=t,this.refresh()},text:function(t){var e=this;this._dataSource.view().ForEach(function(i,s){if(i[e.options.textField]===t)return e.options.value=i[e.options.valueField],e.options.text=t,e.options.index=s,e.refresh(),!1})},value:function(t){var e=this;this._dataSource.view().ForEach(function(i,s){if(i[e.options.valueField]===t)return e.options.value=t,e.options.text=i[e.options.textField],e.options.index=s,e.refresh(),!1})},refresh:function(){if(this.element.empty(),this._dataSourceValid()){var t=this,e=this._dataSource.view(),i=[],s=null;e.ForEach(function(e,n){var o=e[t.options.textField];i.push(o),t.options.index===n&&(s=o)});try{this.option("source",i),null!==s&&this.element.val(s)}catch(t){}this._trigger("load"),null!==this.options.height&&this.menu.element.css({"max-height":this.options.height+"px","overflow-y":"auto","overflow-x":"hidden"})}}})}(window.jQuery,window.serenity),function(t,e){t.widget("serenity.contextmenu",t.ui.menu,e._dataWidgetDef),t.widget("serenity.contextmenu",t.serenity.contextmenu,{_target:null,_current:null,options:{dataSource:null,target:null,child:null},html:{item:Handlebars.compile("<li {{cssClass}}><div>{{text}}</div></li>",{noEscape:!0}),itemIcon:Handlebars.compile("<li {{cssClass}}><div><span class='{{icon}}'></span>{{text}}</div></li>",{noEscape:!0}),divider:"<div class='ui-menu-divider ui-widget-content'></div>"},_create:function(){var e=this;this._super(),this.element.attr("style","display:inline-block;position:absolute;"),this.element.hide(),this.element.appendTo("body"),this.target(this.options.target,this.options.child),t("body").on("click.contextmenu",function(){e.element.hide("blind",null,200)}),this.setDataSource(this.options.dataSource)},_onDataSourceChange:function(){this.refresh()},_onContextMenu:function(e){e.preventDefault(),this.open(t(e.currentTarget),e.pageY,e.pageX)},setDataSource:function(t){this._super(t),this.refresh()},open:function(t,e,i){return this._current=t,this._trigger("beforeOpen",null,{target:t}),this.element.css({top:e,left:i}),this.element.show("blind",null,200),this},refresh:function(){if(this._dataSourceValid()){var e=this._dataSource.view(),i=this,s=null;this.element.empty(),e.ForEach(function(e,n){if(!0===e.divider)s=i.html.divider;else{var o=e.icon?i.html.itemIcon:i.html.item;s=t(o({text:e.text,cssClass:e.disabled?"class='ui-state-disabled'":"",icon:e.icon})),e.icon&&"ui-icon-"===e.icon.substr(0,8)&&s.find("span").addClass("ui-icon")}i.element.append(s)});try{this._super()}catch(t){}this._trigger("load")}else this._super()},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),i.target=this._current,this._trigger("select",e,i)},target:function(e,i){return e&&(null!=this._target&&this._target.off(".contextmenu"),this._target=t(e),i?this._target.on("contextmenu.contextmenu",i,t.proxy(this._onContextMenu,this)):this._target.on("contextmenu.contextmenu",t.proxy(this._onContextMenu,this))),this}})}(window.jQuery,window.serenity),function(t,e){t.widget("serenity.dropdownlist",t.ui.selectmenu,t.extend(!0,{},e._dataWidgetDef)),t.widget("serenity.dropdownlist",t.serenity.dropdownlist,{_previousIndex:null,options:{dataSource:[],height:null,index:null,itemTemplate:null,textTemplate:null,text:null,textField:"text",value:null,valueField:"value"},html:{option:Handlebars.compile("<option {{attr}}>{{text}}</option>",{noEscape:!0})},_create:function(){this._super(),this.setDataSource(this.options.dataSource)},_onDataSourceChange:function(){this.refresh()},_select:function(t,e){this._previousIndex=this.element[0].selectedIndex,this._super(t,e)},_renderButtonItem:function(t){var e=this._super(t);if("function"==typeof this.options.textTemplate&&this._dataSourceValid()){var i=this.options.textField,s=this._dataSource.view().Where(function(e){return e[i]===t.label}).FirstOrDefault(),n=this.options.textTemplate(s);e.html(n)}return e},_renderItem:function(t,e){var i=this._super(t,e);if(this._dataSourceValid()&&null!==this.options.itemTemplate){var s=i.index(),n=this._dataSource.view().ElementAt(s),o=this.options.itemTemplate(n);i.children("div").html(o)}return i},open:function(){this._super();var t=this._getSelectedItem().get(0);t.parentNode.scrollTop=t.offsetTop},previousDataItem:function(){var t=null;if("number"==typeof this._previousIndex)try{t=this.dataSource().view().Skip(this._previousIndex).Take(1).First()}catch(t){}return t},dataItem:function(){var t=this,e=this.element.select().find("option:selected").val();return this._dataSource.view().Where(function(i){return JSON.stringify(i[t.options.valueField])==e}).FirstOrDefault()},setDataSource:function(t){this._super(t),this._dataSourceValid()&&(null!==this.options.index?this.index(this.options.index):null!==this.options.value?this.value(this.options.value):null!==this.options.text?this.text(this.options.text):this.refresh())},index:function(t){this.options.index=t,this.refresh()},text:function(t){var e=this;this._dataSource.view().ForEach(function(i,s){if(i[e.options.textField]==t)return e.options.value=i[e.options.valueField],e.options.text=i[e.options.textField],e.options.index=s,e.refresh(),!1})},value:function(t){var e=this;!1!=this.element.select().find("option:selected").length>0&&this.options.value===t||this._dataSource.view().ForEach(function(i,s){if(i[e.options.valueField]==t)return e.options.value=i[e.options.valueField],e.options.text=i[e.options.textField],e.options.index=s,e.refresh(),!1})},refresh:function(){if(this.element.empty(),this._dataSourceValid()){var i=this._dataSource.view(),s=this;i.ForEach(function(i,n){var o=t(s.html.option({attr:null!==s.options.valueField?e.format("value='{0}'",JSON.stringify(i[s.options.valueField])):"",text:null!==s.options.textField?i[s.options.textField]:""}));s.options.index===n&&o.attr("selected","selected"),s.element.append(o)});try{this._super()}catch(t){}this._trigger("dataBound"),null!==this.options.height&&this.menuWidget().css("height",this.options.height+"px")}}})}(window.jQuery,window.serenity),function(t,e){t.widget("serenity.combobox",t.serenity.autocomplete,{options:{minLength:0,delay:0},html:{wrapper:"<span class='sr-combobox-wrapper' style='display:inline-block;position:relative;'></span>"},_open:null,_create:function(){var e=t(this.html.wrapper);this.element.before(e),e.append(this.element),t("<a>").appendTo(e).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("ui-corner-right").css({position:"absolute",top:0,bottom:0,"margin-left":"-1px"}).on("mousedown",t.proxy(this._onShowListMouseDown,this)).on("click",t.proxy(this._onShowListClick,this)),this._super(),this.widgets.wrapper=e},_onShowListMouseDown:function(){this._open=this.menu.element.is(":visible")},_onShowListClick:function(){if(!1===this._open){var t=this.element.val();this.element.trigger("focus"),this.search(t)}}})}(window.jQuery,window.serenity),function(t,e){"use strict";t.widget("serenity.timepicker",t.serenity.dropdownlist,{_modeFormat:{12:"{0:hh}:{0:mm} {0:tt}",24:"{0:t}"},options:{min:"12:00 AM",max:"11:30 PM",interval:30,mode:"12",date:null,text:null,height:250,width:150,valueField:"value",textField:"text"},setDataSource:function(){var t=this,i=Enumerable.From(e.time.list(this.options.min,this.options.max,this.options.interval,this.options.mode)).Select(function(e){return{value:e,text:"12"==t.options.mode?e.replace("00:","12:"):e}}).ToArray(),s=new e.DataSource({data:i});if(null!==this.options.date){var n=e.format(this._modeFormat[this.options.mode],this.options.date);n="12"===this.options.mode?n.replace("00:","12:"):n,this.options.text=n}this._super(s)}})}(window.jQuery,window.serenity),function(t,e){t.widget("serenity.table",t.serenity.datawidget,{_widths:null,html:{header:{html:"<div class='sr-table-header ui-widget-content'><table class='ui-widget-content' style='width:100%;'><colgroup></colgroup><tr></tr></table></div>",colgroup:{col:"<col style='{0};'/>"},column:{html:"<th data-field='{0}' class='ui-widget-header' style='position:relative;'><span class='sr-table-col-text'>{1}</span></th>",action:{html:"<div class='sr-table-col-actions'></div>",sort:"<span class='sr-table-col-sort fa fa-sort{0}'></span>",filter:{icon:"<span class='fa fa-filter'></span>",popup:"<div class='sr-table-col-filter-popup' style='position:absolute;right:0px;width:200px;display:none;'></div>"}}}},body:{html:"<div class='sr-table-body ui-widget-content' style='{0}'><table style='width:100%;'><colgroup></colgroup></table></div>"},calc:{html:"<div class='sr-table-calc'><table class='ui-widget-content' style='width:100%;'><colgroup></colgroup><tr></tr></table></div>",colgroup:{col:"<col style='{0};'/>"},column:Handlebars.compile("<th data-field='{{field}}' class='ui-widget-header' style='position:relative;'><span class='sr-table-col-text' style='{{styles}}'>{{html}}</span></th>",{noEscape:!0})},pager:{html:"<div class='sr-table-pager'></div>"}},options:{rowCss:null,altRowCss:"sr-table-altrow",columns:null,dataSource:[],pageable:!1,selectionmode:"none",showCalculations:!1,rowTemplate:"<tr></tr>"},_create:function(){this._widths=[],this._super(),this.setDataSource(this.options.dataSource),this.element.on("click.serenityTable","th.sr-table-col-sortable",t.proxy(this._onColumnSort,this)),this.element.on("click.serenityTable","th div.sr-table-col-actions span.fa-filter",t.proxy(this._onColumnFilter,this)),"none"!==this.options.selectionmode&&(this.element.addClass("sr-selectable"),this.element.on("click.serenityTable","div.sr-table-body tbody tr",t.proxy(this._onRowSelect,this)))},_onColumnSort:function(e){if(!(t(e.target).closest("div.sr-table-col-actions").length>0&&!1===t(e.target).hasClass("sr-table-col-sort"))){var i=t(e.currentTarget),s=i.attr("data-field"),n=i.attr("data-sort-dir");switch(n){case"asc":n="desc";break;case"desc":n="";break;default:n="asc"}var o=Enumerable.From(this._dataSource.sort()).Where(function(t){return t.field!==s}).ToArray();o.push({field:s,dir:n}),this._dataSource.sort(o)}},_onColumnFilter:function(e){e.stopPropagation();var i=t(e.currentTarget),s=i.closest("div.sr-table-col-actions"),n=s.closest("th").attr("data-field");this.widgets.filtermenu.element.appendTo(s),this.widgets.filtermenu.load(n),this.widgets.filtermenu.element.show("down"),t("body").on("click.tablefiltermenu",t.proxy(this._onBodyClick,this))},_onBodyClick:function(e){if(this.widgets.filtermenu&&this.widgets.filtermenu.element.is(":visible")){var i=t(e.target);0===i.closest("div.sr-filtermenu").length&&!1===i.hasClass("ui-menu-item-wrapper")&&(this.widgets.filtermenu.element.hide("blind",null,200),t("body").off(".tablefiltermenu"))}},_onRowSelect:function(e){var i=t(e.currentTarget);"multiplerows"===this.options.selectionmode?i.hasClass("ui-state-active")?i.removeClass("ui-state-active"):i.addClass("ui-state-active"):(this.widgets.body.find("tr").removeClass("ui-state-active"),i.addClass("ui-state-active")),this._trigger("select",e)},_renderColumnHeader:function(i,s,n){var o=void 0!==i.title?i.title:"",a=t(e.format(this.html.header.column.html,i.field,o)),r=t(this.html.header.column.action.html);if(!0===i.sortable){a.addClass("sr-table-col-sortable");var l=Enumerable.From(this._dataSource.options.sort).Where(function(t){return t.field===i.field}).FirstOrDefault(),d=e.format(this.html.header.column.action.sort,void 0!==l?"-"+l.dir:"");void 0!==l&&a.attr("data-sort-dir",l.dir),r.append(d)}return!0===i.filterable&&(a.addClass("sr-table-col-filterable"),r.append(this.html.header.column.action.filter.icon)),a.append(r),n.append(a),a},_renderHeader:function(){var i=this;this.widgets.header=t(this.html.header.html);for(var s=this.widgets.header.find("tr"),n=0;n<this.options.columns.length;n++){var o=t(e.format(this.html.header.colgroup.col,this._widths[n].width));this.widgets.header.find("colgroup").append(o);var a=this.options.columns[n];this._renderColumnHeader(a,n,s)}this.element.append(this.widgets.header),Enumerable.From(this.options.columns).Where(function(t){return!0===t.filterable}).Count()>0&&(this.element.append(this.html.header.column.action.filter.popup),this.widgets.filtermenu=this.element.find("div.sr-table-col-filter-popup").serenityFiltermenu({dataSource:this._dataSource,clear:function(){i.widgets.filtermenu.element.hide("up")},filter:function(){i.widgets.filtermenu.element.hide("up")}}).data("serenityFiltermenu"))},_renderRow:function(i,s,n){var o="string"==typeof this.options.rowTemplate?this.options.rowTemplate:this.options.rowTemplate(i),a=t(o);n.append(a),null!==this.options.rowCss&&a.index()%2==0&&a.addClass(this.options.rowCss),null!==this.options.altRowCss&&a.index()%2!=0&&a.addClass(this.options.altRowCss);for(var r=0;r<this.options.columns.length;r++){var l=this.options.columns[r],d=i[l.field];void 0!==d&&null!==d||(d=""),a.append(e.format("<td{0}>{1}</td>",l.styles?" style='"+l.styles+"'":"","function"==typeof l.template?l.template(i):"string"==typeof l.template?Handlebars.compile(l.template)(i):d.toString()))}},_renderBody:function(){this.widgets.body=t(String.format(this.html.body.html,"undfined"!=typeof this.options.height?String.format("height:{0}",this.options.height):""));for(var i=this.widgets.body.find("table"),s=0;s<this.options.columns.length;s++){var n=t(e.format(this.html.header.colgroup.col,this._widths[s].width));i.find("colgroup").append(n)}this.element.append(this.widgets.body)},_renderAggregates:function(){this.widgets.calc=t(this.html.calc.html);for(var i=this.widgets.calc.find("tr"),s=this._dataSource.calculations(),n=0;n<this.options.columns.length;n++){var o=t(e.format(this.html.header.colgroup.col,this._widths[n].width));this.widgets.calc.find("colgroup").append(o);var a=this.options.columns[n],r=s[a.field],l="";if(void 0!==r)if("string"==typeof a.footerTemplate){var d=Handlebars.compile(a.footerTemplate);l=d(r)}else if("function"==typeof a.footerTemplate)l=a.footerTemplate(r);else for(var h in r)l+=e.format("{0}{1}{2}: {3}",l.length>0?"<br/>":"",h[0].toUpperCase(),h.substr(1),r[h]);else"string"==typeof a.footerTemplate&&(l=a.footerTemplate);var c=t(this.html.calc.column({field:a.field,styles:a.footerStyles||"",html:l}));i.append(c)}this.element.append(this.widgets.calc)},_renderPager:function(t){this.element.append(this.html.pager.html),this.widgets.pager=this.element.find("div.sr-table-pager").serenityPagerpanel(t).data("serenityPagerpanel")},_calculateColumnWidths:function(){for(var t=(100/this.options.columns.length).toString()+"%",e=0;e<this.options.columns.length;e++){var i=this.options.columns[e],s=void 0!==i.width;this._widths.push({width:String.format("width:{0}",s?i.width:t),hasWidth:s})}for(var n=!1,o=this._widths.length-1;o>=0&&!1===n;o--)!0==(n=!1===this._widths[o].hasWidth)&&(this._widths[o].width="")},_postRender:function(){},_onDataSourceChange:function(t){this.render()},load:function(){var t=this,e=this.widgets.body.find("table");e.find("tr").remove(),this._dataSourceValid()&&this._dataSource.page().ForEach(function(i,s){t._renderRow(i,s,e)})},render:function(){var i=this;if(null!==this._dataSource&&this._dataSource instanceof e.DataSource){if(this.element.empty(),this._calculateColumnWidths(),this._renderHeader(),this._renderBody(),this.load(),this.options.showCalculations&&null!==this._dataSource.calculations()&&this._renderAggregates(),this.options.pageable){var s=t.extend(!0,{},{dataSource:this._dataSource},"object"==typeof this.options.pageable?this.options.pageable:{});this._renderPager(s)}var n=this.widgets.body.find("table");if(this.widgets.body.height()<n.height()){var o=e.getScrollBarWidth(),a=t(e.format(this.html.header.colgroup.col,e.format("width:{0}px",o)));this.widgets.header.find("table tr").append("<th class='ui-widget-header'></th>"),this.widgets.header.find("colgroup").append(a),this.options.showCalculations&&(this.widgets.calc.find("table tr").append("<th class='ui-widget-header'></th>"),this.widgets.calc.find("colgroup").append(a[0].outerHTML))}this._postRender(),
i._trigger("dataBound")}},setDataSource:function(t){return this._super(t),this.render(),this},selectedRows:function(){return this.widgets.body.find("tr.ui-state-active")},selectedRowItems:function(){var e=[],i=this.dataSource().page();return this.selectedRows().each(function(s,n){var o=t(n).index();e.push(i.ElementAt(o))}),e}})}(window.jQuery,window.serenity),function(t,e){"use strict";t.widget("serenity.panel",t.serenity.widget,{html:{heading:"<div class='sr-panel-heading ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-top'></div>",title:"<div class='sr-panel-title'></div>",expander:"<span class='sr-panel-expander'></span>",body:"<div class='sr-panel-body ui-widget-content ui-corner-bottom'></div>"},options:{collapsible:!1,collapsed:!1,title:"",body:"",expander:{collapse:"fa fa-minus-circle",expand:"fa fa-plus-circle"},width:"100%"},_create:function(){this._super(),this.render()},render:function(){var e=this;this.element.addClass("ui-widget ui-accordion"),this.element.css("width",this.options.width);var i=this.element.children("div");this.element.prepend(this.html.heading),this.widgets.heading=this.element.find(".sr-panel-heading"),0===i.length?(this.widgets.heading.append(this.html.title),this.title(this.options.title),this.element.append(this.html.body),this.widgets.body=this.element.find(".sr-panel-body"),this.body(this.options.body)):2===i.length&&(t(i[0]).addClass("sr-panel-title").appendTo(this.widgets.heading),this.widgets.body=t(i[1]),this.widgets.body.addClass("sr-panel-body ui-widget-content ui-corner-bottom")),this.widgets.body=this.element.find(".sr-panel-body"),this.collapsible(this.options.collapsible),this.options.collapsible&&this.options.collapsed&&this.toggle(!1),this.element.on("click.sr-panel",".sr-panel-heading.sr-panel-collapsible",function(){e.toggle.call(e)})},toggle:function(t){var e=this.widgets.body.is(":visible");return(0===arguments.length||t&&!e||!t&&e)&&(e?(this.widgets.expander.removeClass(this.options.expander.collapse).addClass(this.options.expander.expand),this.widgets.heading.addClass("ui-corner-bottom"),this.widgets.body.hide(),this._trigger("close")):(this.widgets.expander.removeClass(this.options.expander.expand).addClass(this.options.expander.collapse),this.widgets.heading.removeClass("ui-corner-bottom"),this.widgets.body.show(),this._trigger("open"))),this},title:function(t){return this.widgets.heading.find(".sr-panel-title").text(t),this},body:function(t){this.widgets.body.html(t)},collapsible:function(t){this.widgets.heading.find(".sr-panel-expander").remove(),!0===t||"left"===t?(this.widgets.heading.prepend(this.html.expander),this.widgets.expander=this.widgets.heading.find(".sr-panel-expander"),this.widgets.expander.addClass("sr-panel-expander-left"),this.widgets.expander.addClass(this.options.expander.collapse),this.widgets.heading.addClass("sr-panel-collapsible")):"right"===t&&(this.widgets.heading.append(this.html.expander),this.widgets.expander=this.widgets.heading.find(".sr-panel-expander"),this.widgets.expander.addClass("sr-panel-expander-right"),this.widgets.expander.addClass(this.options.expander.collapse),this.widgets.heading.addClass("sr-panel-collapsible"))}})}(window.jQuery,window.serenity),function(t){"use strict";t.widget("serenity.notification",t.serenity.widget,{_container:null,html:{container:"<div class='sr-notification-container'></div>",instance:"<div class='ui-widget ui-widget-content sr-notification-instance' style='display:none;'></div>",instanceContainer:"<div class='sr-notification-instance-container'></div>"},options:{position:{top:null,left:null,bottom:20,right:20},animation:{show:"bottom",hide:"bottom"},cssClass:"",hideOnClick:!0,duration:3e3,width:200},_create:function(){this._super(),this.render()},render:function(){return this.element.hide(),this.widgets.container=t(this.html.container),this.widgets.container.appendTo("body"),this.widgets.panels={},this._trigger("render"),this},show:function(e){var i={},s=this,n=t(window),o=t(this.element.children()[0]);arguments.length>0&&(o=e instanceof jQuery?e:"string"==typeof e?t(e):o);var a=t(this.html.instance);a.append(o.html().trim()),a.css("width",this.options.width+"px").addClass(this.options.cssClass);var r=t(this.html.instanceContainer);r.append(a),null!==this.options.position.bottom?r.prependTo(this.widgets.container):r.appendTo(this.widgets.container),r.css("height",a.outerHeight()+"px");var l=a.serenityNotificationpanel({show:function(t,e){s._trigger("show",null,{panel:e.sender})},hide:function(t,e){s._trigger("hide",null,{panel:e.sender}),e.sender.element.remove(),e.sender.destroy(),delete s.widgets.panels[e.sender.uuid],0===s.widgets.container.find("div.sr-notification-instance").length&&(s.widgets.container.empty(),s._trigger("hide",null,{panel:e.sender}))},click:function(t,e){s._trigger("click",t,{panel:e.sender})}}).data("serenityNotificationpanel");return this.widgets.panels[l.uuid]=l,null!==this.options.position.right?i.left=n.width()+n.scrollLeft()-0-a.outerWidth()-this.options.position.right+"px":null!==this.options.position.left&&(i.left=n.scrollLeft()+this.options.position.left+"px"),null!==this.options.position.bottom?i.top=n.height()+n.scrollTop()-0-this.widgets.container.outerHeight()-this.options.position.bottom+"px":null!==this.options.position.top&&(i.top=n.scrollTop()+this.options.position.top+"px"),this.widgets.container.css("width",this.options.width+"px").css(i),l.show(this),l},hide:function(t){var e=this.widgets.panels[t];return void 0!==e&&e.hide(),this},hideAll:function(){for(var t in this.widgets.panels){this.widgets.panels[t].hide()}return this}})}(window.jQuery),function(t,e){"use strict";t.widget("serenity.tree",t.serenity.datawidget,{_mode:null,html:{root:"<ul class='sr-tree-root'></ul>",node:Handlebars.compile("<li class='sr-tree-node sr-tree-{{expanded}}' data-uuid='{{uuid}}'><i class='sr-tree-node-arrow {{arrow}}' aria-hidden='true'></i><div class='sr-tree-node-text'><div>{{text}}</div></div></li>",{noEscape:!0}),imageCss:"<i class='sr-icon sr-node-icon {{imageCss}}'></i>",imageUrl:"",children:"<ul class='sr-tree-children'></li>"},options:{itemFields:{id:"id",parent:"parent",text:"text",hasChildren:"hasChildren",expanded:"expanded",imageCss:"imageCss",imageCssExpand:"imageCssExpand"},textTemplate:null},_create:function(){this._super(),this.element.addClass("ui-widget ui-widget-content"),this.element.append(this.html.root),this.widgets.root=this.element.find(".sr-tree-root"),this.setDataSource(this.options.dataSource),this._createEvents()},_onDataSourceChange:function(t){if("add"===t.action){var e=this.options.itemFields,i=this.dataSource().get(function(i){return i[e.id]===t.item[e.parent]}),s=this.itemNode(i),n=s.children(".sr-tree-children");n.children(".sr-tree-node-loading").remove();this._addNodeElement(n,t.item).append(this.html.children)}else"remove"===t.action&&this.itemNode(t.item).remove()},_createEvents:function(){this.element.on("click",".sr-tree-node-arrow",t.proxy(this._onClickNodeArrow,this)),this.element.on("click",".sr-tree-node-text",t.proxy(this._onClickNodeText,this))},_onClickNodeArrow:function(e){var i=t(e.currentTarget).parent();i.hasClass("sr-tree-expand")?this.collapseNode(i):this.expandNode(i)},_onClickNodeText:function(e){this.element.find(".ui-state-active").removeClass("ui-state-active");var i=t(e.currentTarget),s=i.closest("li.sr-tree-node");this.selectNode(s)},_addNodeElement:function(e,i){var s=this.options.itemFields,n=!0===i[this.options.itemFields.expanded],o="flat"===this._mode?this.dataSource().view().Where(function(t){return t[s.parent]===i[s.id]}).Count()>0||"function"==typeof this.options.loadOnDemand&&!1!==i[s.hasChildren]:t.isArray(i.children),a=null===this.options.textTemplate?i[s.text]:"function"==typeof this.options.textTemplate?this.options.textTemplate(i):Handlebars.compile(this.options.textTemplate,{noEscape:!0})(i),r=this.html.node({uuid:i.UUID,expanded:n?"expand":"collapse",arrow:o?n?"ui-icon ui-icon-triangle-1-se":"ui-icon ui-icon-triangle-1-e":"",text:a}),l=t(r);return n?"string"==typeof i[this.options.itemFields.imageCssExpand]&&l.find(".sr-tree-node-text").prepend(this.html.imageCss.replace("{{imageCss}}",i[this.options.itemFields.imageCssExpand])):"string"==typeof i[this.options.itemFields.imageCss]&&l.find(".sr-tree-node-text").prepend(this.html.imageCss.replace("{{imageCss}}",i[this.options.itemFields.imageCss])),e.append(l),l},_addNodeElements:function(e,i){var s=this,n=this.options.itemFields;i.ForEach(function(i){var o=s._addNodeElement(e,i);if("flat"===s._mode){var a=s.dataSource().view().Where(function(t){return t[n.parent]===i[n.id]});s._addChildNodes(o,a)}else t.isArray(i[n.children])&&s._addChildNodes(o,Enumerable.From(i[n.children]))})},_rootNodes:function(t){this.widgets.root.empty(),this._addRootNodes(t)},_addRootNodes:function(t){this._addNodeElements(this.widgets.root,t)},_addChildNodes:function(t,e){var i=t.children(".sr-tree-children");0===i.length&&(t.append(this.html.children),i=t.children(".sr-tree-children")),this._addNodeElements(i,e)},_expandNode:function(t){var i=null,s=t.children(".sr-tree-node-arrow");t.removeClass("sr-tree-collapse").addClass("sr-tree-expand"),s.removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-se");var n=t.children(".sr-tree-node-text").children(".sr-node-icon");return n.length>0&&(i=this.nodeItem(t),"string"==typeof i[this.options.itemFields.imageCssExpand]&&n.attr("class",e.format("sr-icon sr-node-icon {0}",i[this.options.itemFields.imageCssExpand]))),i},setDataSource:function(t){this._super(t),this.render()},render:function(){if(this._dataSourceValid()){var t=this.options.itemFields,e=null;this._mode="flat","flat"===this._mode&&(e=this.dataSource().view().Where(function(e){return void 0===e[t.parent]||null===e[t.parent]})),this._rootNodes(e),this._trigger("dataBound")}},nodeItem:function(t){var e=t.attr("data-uuid");return this.dataSource().view().Where(function(t){return t.UUID===e}).FirstOrDefault()},itemNode:function(t){return this.element.find(e.format("li[data-uuid='{0}']",t.UUID))},expandNode:function(t){var e=this._expandNode(t),i=t.children(".sr-tree-children");"function"==typeof this.options.loadOnDemand&&0===i.children(".sr-tree-node").length&&(e=null===e?this.nodeItem(t):e,i.append("<li class='sr-tree-node sr-tree-expand sr-tree-node-loading'><div class='sr-tree-node-text'>Loading...</div></li>"),this.options.loadOnDemand(e,t,function(){i.children(".sr-tree-node-loading").remove(),0===i.children().length&&i.prevAll(".sr-tree-node-arrow").attr("class","sr-tree-node-arrow")})),this._trigger("expand",null,{node:t})},collapseNode:function(t){var i=t.children(".sr-tree-node-arrow");t.removeClass("sr-tree-expand").addClass("sr-tree-collapse"),i.removeClass("ui-icon-triangle-1-se").addClass("ui-icon-triangle-1-e");var s=t.children(".sr-tree-node-text").children(".sr-node-icon");if(s.length>0){var n=this.nodeItem(t);"string"==typeof n[this.options.itemFields.imageCss]&&s.attr("class",e.format("sr-icon sr-node-icon {0}",n[this.options.itemFields.imageCss]))}this._trigger("collapse",null,{node:t})},toggleNode:function(t,e){e?this.expandNode(t):this.collapseNode(t)},selectNode:function(t){this.element.find(".ui-state-active").removeClass("ui-state-active"),t.children(".sr-tree-node-text").addClass("ui-state-active"),this._trigger("select",null,{node:t})},add:function(e){if(t.isArray(e))for(var i=0;i<e.length;i++)this.dataSource().add(e[i]);else"object"==typeof e&&this.dataSource().add(e);return this},remove:function(e){var i=this.dataSource(),s=this.options.itemFields,n=function(t){var e=i.get(function(e){return e[s.parent]==t[s.id]});Enumerable.From(e).ForEach(function(t){n(t),i.remove(t)})};if(t.isArray(e))for(var o=0;o<e.length;o++)n(e[o]),i.remove(e[o]),this.itemNode(item).remove();else"object"==typeof e&&(n(e),i.remove(e),this.itemNode(e).remove());return this},findByText:function(e){var i=this.dataSource().get(function(t){return t.text===e});return t.isArray(i)&&(i=i[0]),this.findByUuid(i.UUID)},findByUuid:function(t){return this.element.find(e.format("li[data-uuid='{0}']",t))},parent:function(t){return t.parent().closest("li.sr-tree-node")},expandTo:function(t){if(!1===t.is(":visible")){var e=this.parent(t);this._expandNode(e),this.expandTo(e)}}})}(window.jQuery,window.serenity);